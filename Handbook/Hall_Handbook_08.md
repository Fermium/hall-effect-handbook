### Measurements at constant $I$ and $B$ while varying the temperature


The stainless-steel dewar can be filled of liquid nitrogen or a mixture of acetone and dry-ice (solid carbon dioxyde). The cold finger (the aluminum bar screwed into the base of the sample) is surrounded by the liquid nitrogen, allowing the sample to be cooled .

The temperature is measured by a type K (Chromel-Alumel) thermocouple thermally coupled to the sample. The small voltage generated by the thermocouple is amplified by an AD8495[^AD8495] integrated circuit. The output (roughly proportional to the temperature with a sensitivity of $\approx 5\frac { mV }{ \,^{\circ}\mathrm{K} }$ is amplified by a non-inverting amplifier (not shown in picture) to get $\approx 10\frac { mV }{ \,^{\circ}\mathrm{K} }$ and shifted to obtain $V_{out \, T}=2.5V$ at $273.15\,^{\circ}\mathrm{K}=0\,^{\circ}\mathrm{C}$. While the K type thermocouple is fairly linear in a small range near room temperature, it is not linear in the whole temperature range covered by the apparatus, as can be seen in figure {@fig:seebeckNonlinearity}.

[^AD8495]: [AD8495 datasheet, Analog Semiconductors](http://www.analog.com/en/products/amplifiers/specialty-amplifiers/thermocouple-interface-amplifiers/AD8495.html)

![In every type of thermocouple, the Seebeck coefficiently $\frac{\mu V}{\,^{\circ}\mathrm{C}}$ is heavly non-linear in relation to the temperature.](Media/seebeck_coefficient_vs_temperature.png){#fig:seebeckNonlinearity}
\ 

In order to get a correct measurement it is necessary to compensate for the non-linearity (see figure {@fig:seebeckNonlinearity}) of the thermocouple using the following polynomial:

$$t=d_{ 0 }+d_{ 1 }E+d_{ 2 }E^{ 2 }+...+d_{ n }E^{ n }$$ {#eq:compensatingPolynomial}
where $E$ is the output voltage of the thermocouple in $mV$.

A fitting polynomial ({@eq:compensatingPolynomial}) of the fifth order is sufficient, given the precision of our equipment.

The table {@tbl:kcoefftable} shows the polynomial coefficients obtained from a best fit of the NIST[^srdata] data tables.

| Coefficient     | Value        |
| :-------------- | :------------ |
| $d_0$           | $0.3837$      |
| $d_1$           | $25.22$       |
| $d_2$           | Â­$0.2795$      |
| $d_3$           | $0.07205$     |
| $d_4$           | $0.01409$     |
| $d_5$           | $0.001056$    |

Table: Polynomial coefficients obtained from NIST K thermocouple tables ($-200< t \, [^{\circ}\mathrm{C}] <200$). {#tbl:kcoefftable}

[^srdata]: NIST t-90 tables for K type thermocouples, http://srdata.nist.gov/its90/download/type_k.tab

The voltage $E$ at the thermocouple junction can be obtained[^AD8495nist] from the following equation:
$$E=\frac { 1 }{ 2 } \frac {  V_{ outT }-{ V }_{ Ref }-{ V }_{ Offset } }{ Gain } $$ {#eq:voltageAtThermocoupleJunction}


where $V_{outT}$ is the output of the instrument (on the front panel), $V_{Ref}=2.5V$ the voltage that indicates a temperature $T=0\,^{\circ}\mathrm{C}$, $V_{offset}$ is the error voltage at $0\,^{\circ}\mathrm{C}$ to achieve 125 mV at $25\,^{\circ}\mathrm{C}$ and $Gain$ is the internal gain of the AD8495 amplifier.

Using the fitting polynomial  ({@eq:compensatingPolynomial}) allows us to finally obtain the  temperature in Celsius:

$$t={ f }_{ comp }\left( E \right)$$ {#eq:FcompE}
$$t={ f }_{ comp } \left( \frac { 1 }{ 2 } \frac { V_{ out }-2.5-1.25\cdot 10^{ -3 } }{ 122.4 } \right) $$ {#eq:ad8494Compensated}

[^AD8495nist]: [AN-1087, Analog Semiconductors](http://www.analog.com/media/en/technical-documentation/application-notes/AN-1087.PDF)
\ 

A possible implementation in C code is the following:


\clearpage

```c
#define THERMOCOUPLE_OFFSET 0.00125
#define THERMOCOUPLE_GAIN 122.4
float b[6]={-0.383695902,25.215123839,-0.279516961,0.072045800,-0.014094503,0.001055528};
float lin_extrap_temp(float E){ //E is the voltage at the thermocouple output
    float t=0;
    E=E*1000; //from V to mV
    t=b[0]+b[1]*E+b[2]*pow(E,2)+b[3]*pow(E,3)+b[4]*pow(E,4)+b[5]*pow(E,5);
    return t;
  }
Float thermocouple_voltage(float vout,float vref){
    return ((vout)-(vref)-THERMOCOUPLE_OFFSET)/(2*THERMOCOUPLE_GAIN);
}
```

A digitally controlled resistive element is wound around the base of the sample, allowing to heath it up after reaching room temperature. The instruments automatically shuts down if $t \ge 170\, \,^{\circ}\mathrm{C}$.
