box: fermiumlabs/latex-docker

build:
  steps:
    - script:
      name: Install dependencies
      code: |
          apt update
          apt install -yq libcurl4-openssl-dev libssh2-1-dev curl 
    - script:
      name: Install R packages
      code: |
          Rscript -e "install.packages('rmarkdown',repos='https://cran.stat.unipd.it/');install.packages('bookdown',repos='https://cran.stat.unipd.it/')"
    - script:
        name: Build
        code: |
          make bookdown_all_compress

deploy:
  steps:
    - edgecaseadmin/install-aws-cli:
           key: $AWS_ACCESS_KEY_ID
           secret: $AWS_SECRET_ACCESS_KEY
    - script:
        name: "Push application build to S3"
        code: |
          aws s3 cp --recursive Exports/ s3://handbooks-autobuild/$WERCKER_GIT_REPOSITORY/
